<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>å…³äºJVMï¼Œä½ å¿…é¡»çŸ¥é“çš„é‚£äº›ç©æ„å„¿ | ClericYi's Blog</title><meta name="description" content="ç±»çš„åŠ è½½æœºåˆ¶å…ˆä½¿ç”¨ä¸€å¼ å›¾æ•´ä¸ªåŠ è½½æœºåˆ¶æ‰€åŒ…å«çš„è¿‡ç¨‹ã€‚  é€šè¿‡è¿™å¼ å›¾æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œå…³äºç±»çš„åŠ è½½å…¶å®å°±æ˜¯å¯ä»¥åˆ†ä¸ºäº”ä¸ªå¤§é˜¶æ®µï¼Œä¸è¿‡ä¸‹é¢æ–‡ä¸­ä¸»è¦ä»åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æè¿˜æœ‰åˆå§‹åŒ–è¿™äº”ä¸ªæ–¹é¢æ¥åšä¸€ä¸ªè®²è§£ï¼š åŠ è½½éœ€è¦å®Œæˆä»¥ä¸‹ä¸‰é¡¹ä»»åŠ¡ï¼š  ï¼ˆ1ï¼‰é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ï¼ˆå¹¶æ²¡æœ‰æŒ‡å®šæ•°æ®å¿…é¡»ä»Classæ–‡ä»¶ä¸­è·å–ï¼‰ ï¼ˆ2ï¼‰å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚"><meta name="author" content="Cleric Yi"><meta name="copyright" content="Cleric Yi"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/avatar.jpg"><link rel="canonical" href="http://yoursite.com/2020/06/24/%E5%85%B3%E4%BA%8EJVM%EF%BC%8C%E4%BD%A0%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84%E9%82%A3%E4%BA%9B%E7%8E%A9%E6%84%8F%E5%84%BF/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="å…³äºJVMï¼Œä½ å¿…é¡»çŸ¥é“çš„é‚£äº›ç©æ„å„¿"><meta property="og:url" content="http://yoursite.com/2020/06/24/%E5%85%B3%E4%BA%8EJVM%EF%BC%8C%E4%BD%A0%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84%E9%82%A3%E4%BA%9B%E7%8E%A9%E6%84%8F%E5%84%BF/"><meta property="og:site_name" content="ClericYi's Blog"><meta property="og:description" content="ç±»çš„åŠ è½½æœºåˆ¶å…ˆä½¿ç”¨ä¸€å¼ å›¾æ•´ä¸ªåŠ è½½æœºåˆ¶æ‰€åŒ…å«çš„è¿‡ç¨‹ã€‚  é€šè¿‡è¿™å¼ å›¾æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œå…³äºç±»çš„åŠ è½½å…¶å®å°±æ˜¯å¯ä»¥åˆ†ä¸ºäº”ä¸ªå¤§é˜¶æ®µï¼Œä¸è¿‡ä¸‹é¢æ–‡ä¸­ä¸»è¦ä»åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æè¿˜æœ‰åˆå§‹åŒ–è¿™äº”ä¸ªæ–¹é¢æ¥åšä¸€ä¸ªè®²è§£ï¼š åŠ è½½éœ€è¦å®Œæˆä»¥ä¸‹ä¸‰é¡¹ä»»åŠ¡ï¼š  ï¼ˆ1ï¼‰é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ï¼ˆå¹¶æ²¡æœ‰æŒ‡å®šæ•°æ®å¿…é¡»ä»Classæ–‡ä»¶ä¸­è·å–ï¼‰ ï¼ˆ2ï¼‰å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚"><meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><meta property="article:published_time" content="2020-06-24T07:28:31.883Z"><meta property="article:modified_time" content="2020-06-24T07:28:43.546Z"><meta name="twitter:card" content="summary"><script>var activateDarkMode = function () {
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#000')
  }
}
var activateLightMode = function () {
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null) {
    document.querySelector('meta[name="theme-color"]').setAttribute('content', '#fff')
  }
}

var getCookies = function (name) {
  const value = `; ${document.cookie}`
  const parts = value.split(`; ${name}=`)
  if (parts.length === 2) return parts.pop().split(';').shift()
}

var autoChangeMode = 'false'
var t = getCookies('theme')
if (autoChangeMode === '1') {
  var isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
  var isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
  var isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined) {
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport) {
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour <= 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
    }
    window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
      if (Cookies.get('theme') === undefined) {
        e.matches ? activateDarkMode() : activateLightMode()
      }
    })
  } else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else if (autoChangeMode === '2') {
  now = new Date()
  hour = now.getHours()
  isNight = hour <= 6 || hour >= 18
  if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode()
} else {
  if (t === 'dark') activateDarkMode()
  else if (t === 'light') activateLightMode()
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="next" title="é”¦å›Šç¯‡ï½œä¸€æ–‡æ‘¸æ‡‚RxJava" href="http://yoursite.com/2020/06/24/%E9%94%A6%E5%9B%8A%E7%AF%87%EF%BD%9C%E4%B8%80%E6%96%87%E6%91%B8%E6%87%82RxJava/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"ç¹","msgToSimplifiedChinese":"ç°¡"},
  copy: {
    success: 'å¤åˆ¶æˆåŠŸ',
    error: 'å¤åˆ¶é”™è¯¯',
    noSupport: 'æµè§ˆå™¨ä¸æ”¯æŒ'
  },
  bookmark: {
    message_prev: 'æŒ‰',
    message_next: 'é”®å°†æœ¬é¡µåŠ å…¥ä¹¦ç­¾'
  },
  runtime_unit: 'å¤©',
  runtime: false,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false    
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isSidebar: true
  }</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.1"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length_num">3</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div></div></div><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">ç›®å½•</div><div class="sidebar-toc__progress"><span class="progress-notice">ä½ å·²ç»è¯»äº†</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ç±»çš„åŠ è½½æœºåˆ¶"><span class="toc-number">1.</span> <span class="toc-text">ç±»çš„åŠ è½½æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#åŠ è½½"><span class="toc-number">1.1.</span> <span class="toc-text">åŠ è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#éªŒè¯"><span class="toc-number">1.2.</span> <span class="toc-text">éªŒè¯</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å‡†å¤‡"><span class="toc-number">1.3.</span> <span class="toc-text">å‡†å¤‡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è§£æ"><span class="toc-number">1.4.</span> <span class="toc-text">è§£æ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åˆå§‹åŒ–"><span class="toc-number">1.5.</span> <span class="toc-text">åˆå§‹åŒ–</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç±»åŠ è½½å™¨"><span class="toc-number">2.</span> <span class="toc-text">ç±»åŠ è½½å™¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åŒäº²å§”æ´¾æ¨¡å‹"><span class="toc-number">3.</span> <span class="toc-text">åŒäº²å§”æ´¾æ¨¡å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å·¥ä½œåŸç†"><span class="toc-number">3.1.</span> <span class="toc-text">å·¥ä½œåŸç†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç ´ååŒäº²å§”æ´¾æ¨¡å‹"><span class="toc-number">3.2.</span> <span class="toc-text">ç ´ååŒäº²å§”æ´¾æ¨¡å‹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¦‚ä½•å¼€å±•ç ´åæ´»åŠ¨"><span class="toc-number">3.2.1.</span> <span class="toc-text">å¦‚ä½•å¼€å±•ç ´åæ´»åŠ¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æº¯æºClassLoader-getSystemClassLoader"><span class="toc-number">3.3.</span> <span class="toc-text">æº¯æºClassLoader.getSystemClassLoader()</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Javaå†…å­˜æ¨¡å‹"><span class="toc-number">4.</span> <span class="toc-text">Javaå†…å­˜æ¨¡å‹</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#GCå›æ”¶æœºåˆ¶"><span class="toc-number">5.</span> <span class="toc-text">GCå›æ”¶æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å †åŒºçš„ç»†èŠ‚åˆ’åˆ†"><span class="toc-number">5.1.</span> <span class="toc-text">å †åŒºçš„ç»†èŠ‚åˆ’åˆ†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¯¹è±¡å­˜æ´»åˆ¤æ–­"><span class="toc-number">5.2.</span> <span class="toc-text">å¯¹è±¡å­˜æ´»åˆ¤æ–­</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¼•ç”¨è®¡æ•°"><span class="toc-number">5.2.1.</span> <span class="toc-text">å¼•ç”¨è®¡æ•°</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¯è¾¾æ€§åˆ†æ"><span class="toc-number">5.2.2.</span> <span class="toc-text">å¯è¾¾æ€§åˆ†æ</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å›æ”¶ç®—æ³•"><span class="toc-number">5.3.</span> <span class="toc-text">å›æ”¶ç®—æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¤åˆ¶æ”¶é›†"><span class="toc-number">5.3.1.</span> <span class="toc-text">å¤åˆ¶æ”¶é›†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ ‡è®°æ¸…ç†"><span class="toc-number">5.3.2.</span> <span class="toc-text">æ ‡è®°æ¸…ç†</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#æ ‡è®°æ•´ç†"><span class="toc-number">5.3.3.</span> <span class="toc-text">æ ‡è®°æ•´ç†</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å…³äºåƒåœ¾å›æ”¶å™¨"><span class="toc-number">5.4.</span> <span class="toc-text">å…³äºåƒåœ¾å›æ”¶å™¨</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å››å¤§å¼•ç”¨"><span class="toc-number">6.</span> <span class="toc-text">å››å¤§å¼•ç”¨</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å‚è€ƒèµ„æ–™"><span class="toc-number">7.</span> <span class="toc-text">å‚è€ƒèµ„æ–™</span></a></li></ol></div></div></div><div class="code-close" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">ClericYi's Blog</a></span><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">å…³äºJVMï¼Œä½ å¿…é¡»çŸ¥é“çš„é‚£äº›ç©æ„å„¿</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="å‘è¡¨äº 2020-06-24 15:28:31"><i class="far fa-calendar-alt fa-fw"></i> å‘è¡¨äº 2020-06-24</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="æ›´æ–°äº 2020-06-24 15:28:43"><i class="fas fa-history fa-fw"></i> æ›´æ–°äº 2020-06-24</span></time></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta__icon"></i><span>é˜…è¯»é‡:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/17298a294a672707?w=1420&h=1104&f=png&s=105326" alt=""></p>
<h1 id="ç±»çš„åŠ è½½æœºåˆ¶"><a href="#ç±»çš„åŠ è½½æœºåˆ¶" class="headerlink" title="ç±»çš„åŠ è½½æœºåˆ¶"></a>ç±»çš„åŠ è½½æœºåˆ¶</h1><p>å…ˆä½¿ç”¨ä¸€å¼ å›¾æ•´ä¸ªåŠ è½½æœºåˆ¶æ‰€åŒ…å«çš„è¿‡ç¨‹ã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/8/17292de0c52cb8ff?w=926&h=303&f=jpeg&s=38820" alt=""></p>
<p>é€šè¿‡è¿™å¼ å›¾æˆ‘ä»¬å¯ä»¥äº†è§£åˆ°ï¼Œå…³äºç±»çš„åŠ è½½å…¶å®å°±æ˜¯å¯ä»¥åˆ†ä¸ºäº”ä¸ªå¤§é˜¶æ®µï¼Œä¸è¿‡ä¸‹é¢æ–‡ä¸­ä¸»è¦ä»åŠ è½½ã€éªŒè¯ã€å‡†å¤‡ã€è§£æè¿˜æœ‰åˆå§‹åŒ–è¿™äº”ä¸ªæ–¹é¢æ¥åšä¸€ä¸ªè®²è§£ï¼š</p>
<h2 id="åŠ è½½"><a href="#åŠ è½½" class="headerlink" title="åŠ è½½"></a>åŠ è½½</h2><p>éœ€è¦å®Œæˆä»¥ä¸‹ä¸‰é¡¹ä»»åŠ¡ï¼š </p>
<p><strong>ï¼ˆ1ï¼‰é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å®šä¹‰æ­¤ç±»çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚ï¼ˆå¹¶æ²¡æœ‰æŒ‡å®šæ•°æ®å¿…é¡»ä»Classæ–‡ä»¶ä¸­è·å–ï¼‰</strong></p>
<p><strong>ï¼ˆ2ï¼‰å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚</strong></p>
<p><strong>ï¼ˆ3ï¼‰åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„è®¿é—®å…¥å£ã€‚</strong></p>
<p> å¾€ç®€å•äº†è¯´ï¼Œå°±æ˜¯ä»æ–‡ä»¶ä¸­è¯»å–äºŒè¿›åˆ¶æ•°æ®ï¼Œå¯¹è·å–åˆ°çš„äºŒè¿›åˆ¶æ•°æ®åšä¸€ä¸ªè½¬åŒ–ï¼Œå˜æˆä¸€ä¸ªJVMèƒ½å¤Ÿè®¤è¯†çš„æ¨¡æ ·ï¼Œ<strong>ä¹Ÿå°±æ˜¯æ–¹æ³•åŒºè¿è¡Œæ—¶çš„æ•°æ®ç»“æ„</strong>ï¼Œç„¶åJVMä¸­ç”Ÿæˆå¯¹åº”çš„å†…å­˜ç©ºé—´ä½œä¸ºå…¥å£ï¼Œåˆ°æ—¶å€™å„ç±»æ•°æ®çš„å…¥å£ã€‚</p>
<h2 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h2><blockquote>
<p>ç¡®ä¿Classæ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚</p>
</blockquote>
<p>ä¸ºä»€ä¹ˆéœ€è¦è¿™ä¹ˆä¸€ä¸ªç¯èŠ‚å‘¢ï¼Ÿ <strong>Classæ–‡ä»¶çš„äº§ç”Ÿï¼Œå¹¶ä¸æ˜¯ä¸€å®šæ¥è‡ªJavaæºç ã€‚</strong> ä»–ç”šè‡³å¯ä»¥ç”±æˆ‘ä»¬ç›´æ¥ç¼–å†™è€Œæˆï¼ŒéªŒè¯èƒ½å¸®æˆ‘è¿‡æ»¤æ‰é”™è¯¯çš„Classæ–‡ä»¶ï¼Œä¿éšœè™šæ‹Ÿæœºçš„æ­£ç¡®è¿è¡Œã€‚</p>
<p><strong>éœ€è¦å®Œæˆä»¥ä¸‹å››é¡¹ä»»åŠ¡ï¼š</strong></p>
<p> <strong>ï¼ˆ1ï¼‰æ–‡ä»¶æ ¼å¼éªŒè¯ï¼š</strong> éªŒè¯å­—èŠ‚æµæ˜¯å¦ç¬¦åˆClassæ–‡ä»¶æ ¼å¼çš„è§„èŒƒï¼Œå¹¶ä¸”èƒ½è¢«å½“å‰ç‰ˆæœ¬çš„è™šæ‹Ÿæœºå¤„ç†ã€‚</p>
<p><strong>ï¼ˆ2ï¼‰å…ƒæ•°æ®éªŒè¯ï¼š</strong> å¯¹ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ä¸­çš„æ•°æ®ç±»å‹ç­‰è¿›è¡Œæ ¡éªŒã€‚ </p>
<p><strong>ï¼ˆ3ï¼‰å­—èŠ‚ç éªŒè¯ï¼š</strong> å¯¹ç±»çš„æ–¹æ³•ä½“è¿›è¡Œæ ¡éªŒï¼Œç¡®ä¿ç¨‹åºè¯­ä¹‰çš„åˆæ³•æ€§ã€‚</p>
<p><strong>ï¼ˆ4ï¼‰ç¬¦å·å¼•ç”¨éªŒè¯ï¼š</strong> ä¿è¯è§£æåŠ¨ä½œçš„æ­£ç¡®æ‰§è¡Œã€‚<strong>ï¼ˆåŠ¨ä½œåœ¨è§£ææ—¶å‘ç”Ÿï¼‰</strong></p>
<h2 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h2><blockquote>
<p>æ­£å¼ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡åˆå§‹å€¼çš„é˜¶æ®µï¼Œè¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜éƒ½å°†åœ¨æ–¹æ³•åŒºä¸­è¿›è¡Œåˆ†é…ã€‚</p>
</blockquote>
<p>è¿™ä¸ªé˜¶æ®µå­˜åœ¨ä¸€ä¸ªæ€è€ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">int</span> i_final_static = <span class="number">123</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> i_static = <span class="number">123</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> i = <span class="number">123</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Q1ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»<code>main()</code>å‡½æ•°ä¸­è°ƒç”¨åˆ°çš„<code>i_static</code>ï¼Œè€Œè°ƒç”¨ä¸åˆ°iå‘¢ï¼Ÿ</strong></p>
<p><strong>A1ï¼š</strong> ä½œä¸ºè¯»è€…çš„ä½ è‚¯å®šä¼šè¯´ï¼Œè¿™ä¸æ˜¯åºŸè¯å—ï¼Œ<code>i_static</code>æ˜¯ç”¨<code>static</code>ä¿®é¥°çš„ï¼Œå½“ç„¶å¯ä»¥è°ƒç”¨ã€‚ä½†æ˜¯è¿™æ˜¯ä»ä½¿ç”¨çš„è§’åº¦æ¥æ€è€ƒäº†ã€‚ </p>
<p>å…¶å®è¿™å°±æ˜¯å‡†å¤‡é˜¶æ®µè¦å¹²çš„äº‹æƒ…äº†ï¼Œåœ¨è¿™ä¸ªé˜¶æ®µï¼Œè™šæ‹Ÿæœºå·²ç»ä¸ºè¿™äº›æ•°æ®åšå¥½äº†å­˜æ”¾çš„å·¥ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½å¤Ÿè°ƒç”¨ã€‚ä½†æ˜¯<code>i</code>è¿™ä¸ªå˜é‡ï¼Œåœ¨ä½ æ²¡æœ‰å®ä¾‹åŒ–ä¹‹å‰ï¼Œä»–æ˜¯æ²¡æœ‰è¢«å­˜æ”¾åœ¨å†…å­˜ç©ºé—´çš„ï¼Œè‡ªç„¶ä¹Ÿå°±ä¸èƒ½å¤Ÿè°ƒç”¨äº†ã€‚æ›´ç›´ç™½çš„è¯´ï¼Œå°±æ˜¯ä½ æ‰¾ä¸åˆ°å‘—ï¼Œæ‰¾ä¸åˆ°æˆ‘æ€ä¹ˆç”¨ã€‚</p>
<p><strong>Q2ï¼šé‚£å¦‚æœ<code>i_final_static</code>å’Œ<code>i_static</code>å‘¢ï¼Œä»–ä»¬åˆä¼šæœ‰ä»€ä¹ˆæ ·çš„åŒºåˆ«ï¼Ÿ</strong></p>
<p><strong>A2ï¼š</strong> è¿™ä¸¤ä¸ªåœ¨å‡†å¤‡é˜¶æ®µçš„å€¼åˆ†åˆ«æ˜¯0å’Œ123ã€‚è¿™æ˜¯å› ä¸ºå¯¹äºæ²¡æœ‰<code>final</code>ä¿®é¥°çš„ç±»è€Œè¨€ï¼Œæ•°æ®åªæœ‰åœ¨åˆå§‹åŒ–æ—¶é€šè¿‡<code>putstatic</code>çš„æŒ‡ä»¤æ‰ä¼šè¿›è¡Œèµ‹å€¼ï¼Œè€Œ<code>final</code>çš„ä½œç”¨æ˜¯å°†æ•°æ®å­˜æ”¾åœ¨äº†<code>ConstantValue</code>çš„å±æ€§ä¸­ï¼Œè¿™æ ·å°±åœ¨å‡†å¤‡é˜¶æ®µæ—¶æ•°æ®å°±å·²ç»å‡†å¤‡å®Œæ¯•äº†ã€‚</p>
<h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><blockquote>
<p>è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<ul>
<li>ç¬¦å·å¼•ç”¨ï¼šç¬¦å·å¼•ç”¨ä»¥ä¸€ç»„ç¬¦å·æ¥æè¿°æ‰€å¼•ç”¨çš„ç›®æ ‡ï¼Œç¬¦å·å¯ä»¥æ˜¯ä»»ä½•å½¢å¼çš„å­—é¢é‡ï¼Œåªè¦ä½¿ç”¨æ—¶èƒ½æ— æ­§ä¹‰åœ°å®šä½åˆ°ç›®æ ‡å³å¯ã€‚</li>
<li>ç›´æ¥å¼•ç”¨ï¼šç›´æ¥å¼•ç”¨å¯ä»¥æ˜¯ç›´æ¥æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆã€ç›¸å¯¹åç§»é‡æˆ–æ˜¯ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ã€‚</li>
</ul>
<p>è§£ææ˜¯ä¸€ä¸ªä¸å®šæ—¶çš„å·¥ä½œå†…å®¹ï¼Œå› ä¸ºåƒ<code>new</code>ï¼Œæ•°ç»„å¼•ç”¨è¿™äº›éƒ½æ˜¯ä¸€ä¸ªè§†æƒ…å†µè€Œå®šçš„äº‹ä»¶ã€‚ä»–æ‰€é’ˆå¯¹çš„åŠ¨ä½œæœ‰ç±»ã€æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æ–¹æ³•ç±»å‹ã€æ–¹æ³•å¥æŸ„å’Œè°ƒç”¨ç‚¹é™å®šç¬¦ã€‚</p>
<h2 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h2><p><strong>åˆå§‹åŒ–é˜¶æ®µå°±æ˜¯æ‰§è¡Œç±»æ„é€ å™¨<code>&lt;clinit&gt;()</code>æ–¹æ³•çš„è¿‡ç¨‹ã€‚</strong> </p>
<p><strong>Q1ï¼šé‚£ä¹ˆ<code>&lt;clinit&gt;()</code>å¹²çš„æ´»åˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿ</strong></p>
<p>ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„æ‰€æœ‰ç±»å˜é‡çš„èµ‹å€¼åŠ¨ä½œå’Œé™æ€è¯­å¥å— <strong>ï¼ˆstatic{}ï¼‰</strong> ç»„åˆäº§ç”Ÿã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bean</span> </span>&#123;</span><br><span class="line">    <span class="comment">// public static int i_static = 123;</span></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        i_static = <span class="number">0</span>;</span><br><span class="line">        System.out.println(i_static); <span class="comment">// å¦‚æœå˜é‡åœ¨åé¢å®šä¹‰å‡ºç°éæ³•å‰å‘å¼•ç”¨æŠ¥é”™</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> i_static = <span class="number">123</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä¸è¿‡æˆ‘æ„Ÿè§‰å˜é‡åœ¨é™æ€è¯­å¥å—ä¹‹åå®šä¹‰å¥½åƒæ²¡ä»€ä¹ˆç”¨ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ï¼Œæ¯•ç«Ÿç»“æœå‘Šè¯‰æˆ‘ä»¬è°å®šä¹‰åœ¨åå¤´ï¼Œå€¼å°±æ˜¯è°çš„ã€‚</p>
<p>çœ‹å®Œäº†é™æ€è¯­å¥å—çš„ä¸€äº›å†…å®¹ï¼Œæˆ‘ä»¬å°±è¦åŠ å…¥çˆ¶å­ç±»ç»§ç»­åˆ¤å®šå®ƒçš„åŠ è½½é¡ºåºäº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Beanç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"Bean static load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Bean()&#123;</span><br><span class="line">        System.out.println(<span class="string">"Bean load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç»§æ‰¿è‡ªBeançš„å­ç±»</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanSon</span> <span class="keyword">extends</span> <span class="title">Bean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"BeanSon static load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BeanSon()&#123;</span><br><span class="line">        System.out.println(<span class="string">"BeanSon load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å…·ä½“è°ƒç”¨</span></span><br><span class="line">Bean bean = <span class="keyword">new</span> BeanSon();</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/1706726ab2b5be1a?w=720&h=97&f=png&s=5252" alt=""></p>
<p>å¯ä»¥å‘ç°åŠ è½½çš„ä¼˜å…ˆé¡ºåºå¦‚ä¸‹ï¼š</p>
<ul>
<li>é™æ€ &gt; å®ä¾‹ï¼›</li>
<li>çˆ¶ç±» &gt; å­ç±»</li>
</ul>
<p>å¦å¤–ä¸€ä¸ªæ˜¯æˆ‘åœ¨ç‰›å®¢ç»ƒä¹ æ—¶çŸ¥é“çš„çŸ¥è¯†ï¼Œå«åšå·¦ç¼–è¯‘å³è¿è¡Œï¼Œå…¶å®æ˜¯å‘ä¸Šè½¬å‹çš„æ¦‚å¿µï¼Œä½†æ˜¯è¿™ç§è®°æ³•æ›´ç”ŸåŠ¨å½¢è±¡ã€‚</p>
<p>ç›´æ¥ç”¨ä»£ç æ¥éªŒè¯è¿™å¥è¯ï¼Œç°åœ¨å°†å­ç±»å’Œçˆ¶ç±»ä¿®æ”¹æˆä»¥ä¸‹å½¢å¼ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// BeanSon</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanSon</span> <span class="keyword">extends</span> <span class="title">Bean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"BeanSon static load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    BeanSon() &#123;</span><br><span class="line">        System.out.println(<span class="string">"BeanSon load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">commonHas</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"commonHas BeanSon"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">doSomething</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"doSomething"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Bean</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Bean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        System.out.println(<span class="string">"Bean static load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Bean()&#123;</span><br><span class="line">        System.out.println(<span class="string">"Bean load"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">commonHas</span><span class="params">()</span></span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"commonHas Bean"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åä½¿ç”¨ä¸Šé¢çš„Mainç±»ä¸­çš„å¯¹è±¡beanå»è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ</p>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/1706726ab39edc0f?w=1240&h=578&f=png&s=112125" alt=""></p>
<p>æ‰¾ä¸åˆ°<code>doSomething()</code>è¿™ä¸ªå‡½æ•°ï¼Ÿè¿™å°±æ˜¯å·¦ç¼–è¯‘çš„æ„æ€äº†ï¼Œè™½ç„¶æ˜¯æŒ‰ç…§å³è¾¹çš„å­ç±»è¿è¡Œï¼Œä½†æ˜¯æ˜¯ä¸ä¼šå°†å­ç±»å¤šå‡ºæ¥çš„æ–¹æ³•åŠ å…¥åˆ°æ–¹æ³•åŒºã€‚<br>å†è°ƒç”¨ä¸Šå›¾ä¸­çš„<code>commonHas()</code>æ–¹æ³•åï¼Œä½ åˆä¼šå‘ç°æ‰“å°çš„ç»“æœæ˜¯è¿™æ ·çš„ã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/1706726ab436c252?w=1240&h=307&f=png&s=47160" alt=""></p>
<p>å®ƒè¿è¡Œå‡ºäº†å­ç±»çš„ç»“æœï¼Œè¿™ä¹Ÿå°±æ˜¯å³è¿è¡Œçš„æ„æ€äº†ã€‚</p>
<h1 id="ç±»åŠ è½½å™¨"><a href="#ç±»åŠ è½½å™¨" class="headerlink" title="ç±»åŠ è½½å™¨"></a>ç±»åŠ è½½å™¨</h1><p>åœ¨Javaè™šæ‹Ÿæœºä¸­ï¼Œç±»åŠ è½½å™¨ååˆ†é‡è¦ã€‚æ¯ä¸€ä¸ªç±»çš„åŠ è½½ï¼Œéƒ½éœ€è¦é€šè¿‡ä¸€ä¸ªç±»çš„åŠ è½½å™¨ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå±äºè‡ªå·±çš„ç±»åŠ è½½å™¨ï¼Œè¿™ä¸ªæ—¶å€™ä¼šå‡ºç°ä¸€ä¸ªä»€ä¹ˆæ ·çš„æƒ…å†µå‘¢ï¼Ÿ<br>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬ç”¨ä»£ç æ¥è¿›è¡ŒéªŒè¯æµ‹è¯•ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassLoaderTest</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        ClassLoader myLoader = <span class="keyword">new</span> ClassLoader() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> Class&lt;?&gt; loadClass(String name) <span class="keyword">throws</span> ClassNotFoundException &#123;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    String fileName = name.substring(name.lastIndexOf(<span class="string">"."</span>) + <span class="number">1</span>) + <span class="string">".class"</span>;</span><br><span class="line">                    InputStream is = getClass().getResourceAsStream(fileName);</span><br><span class="line">                    <span class="keyword">if</span> (is == <span class="keyword">null</span>) &#123;</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">super</span>.loadClass(name);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">byte</span>[] b = <span class="keyword">new</span> <span class="keyword">byte</span>[is.available()];</span><br><span class="line">                    is.read(b);</span><br><span class="line">                    <span class="keyword">return</span> defineClass(name, b, <span class="number">0</span>, b.length);</span><br><span class="line">                &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                    <span class="keyword">throw</span> <span class="keyword">new</span> ClassNotFoundException(name);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="comment">// ç”±è‡ªå·±çš„ç±»åŠ è½½å™¨åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        Object obj = myLoader.loadClass(<span class="string">"XuNiJi.ClassLoaderTest"</span>).newInstance();</span><br><span class="line">        <span class="comment">// ç”±ç³»ç»Ÿæä¾›çš„ç±»åŠ è½½å™¨åŠ è½½åˆ›å»ºå¯¹è±¡</span></span><br><span class="line">        Object obj1 = ClassLoader.getSystemClassLoader().loadClass(<span class="string">"XuNiJi.ClassLoaderTest"</span>).newInstance();</span><br><span class="line">        System.out.println(obj <span class="keyword">instanceof</span> ClassLoaderTest);</span><br><span class="line">        System.out.println(obj1 <span class="keyword">instanceof</span> ClassLoaderTest);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/1706727209b96526?w=1240&h=412&f=png&s=45697" alt=""><br>ä»è¿™é‡Œæƒ³æ¥å·²ç»èƒ½å¤Ÿçœ‹å‡ºäº†ï¼Œç”±ä¸€ä¸ªç±»åŠ è½½å™¨ç»Ÿä¸€åˆ›å»ºçš„ç±»ï¼Œæ‰å­˜åœ¨å¯æ¯”æ€§ã€‚å› ä¸ºç±»åŠ è½½å™¨æ˜¯æ‹¥æœ‰ç‹¬ç«‹çš„ç±»åç§°ç©ºé—´çš„ã€‚æ›´ç®€å•çš„è¯´ï¼Œå°±åƒä¸Šé¢çš„ä¾‹å­ï¼Œå¦‚æœä¸ä½¿ç”¨Javaè™šæ‹Ÿæœºæä¾›çš„ç±»åŠ è½½å™¨ï¼Œä½ å°±ä¼šå¤±å»ä¸€å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œæ¯”å¦‚<code>equals()</code>ã€<code>isAssignableFrom()</code>ã€<code>isInstance()</code>ã€<code>instanceof</code>ã€‚å¦‚æœè¦ç›¸åŒï¼Œé™¤éä½ ç›´æ¥åœ¨javaæºç ä¸ŠåŠ¨æ‰‹è„šã€‚</p>
<h1 id="åŒäº²å§”æ´¾æ¨¡å‹"><a href="#åŒäº²å§”æ´¾æ¨¡å‹" class="headerlink" title="åŒäº²å§”æ´¾æ¨¡å‹"></a>åŒäº²å§”æ´¾æ¨¡å‹</h1><p><strong>Q1ï¼šä¸ºä»€ä¹ˆéœ€è¦è¿™ä¸ªæ¨¡å‹ï¼Ÿ</strong></p>
<p>å…¶å®è¿™ä¸ªæ¨¡å‹çš„æå‡ºï¼Œå°±æ˜¯ä¸ºäº†è§£å†³ç±»åŠ è½½å™¨å¯èƒ½ä¸å‡ºç°ä¸åŒçš„é—®é¢˜ã€‚å› ä¸ºå³ä¾¿æ˜¯ç›¸åŒçš„<code>class</code>ï¼Œç”±ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½æ—¶ï¼Œç»“æœå°±æ˜¯ä¸åŒçš„ã€‚</p>
<h2 id="å·¥ä½œåŸç†"><a href="#å·¥ä½œåŸç†" class="headerlink" title="å·¥ä½œåŸç†"></a>å·¥ä½œåŸç†</h2><p>åŒäº²å§”æ´¾çš„å·¥ä½œæµç¨‹éå¸¸ç®€å•ï¼Œè¿™å°±è·Ÿä¹‹å‰æ–‡ç« é‡Œçš„Androidçš„äº‹ä»¶åˆ†å‘æœºåˆ¶ä¸€æ ·ï¼Œå‘ä¸Šä¼ é€’ï¼Œç”±çˆ¶ç±»åŠ è½½å™¨å…ˆè¡Œå°è¯•æ¶ˆè´¹ï¼Œå¦‚æœçˆ¶ç±»æ— æ³•å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œé‚£ä¹ˆå­åŠ è½½å™¨å°±è¦ç”±è‡ªå·±åŠ¨æ‰‹å®Œæˆã€‚</p>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/17067272067d5bfa?w=874&h=758&f=png&s=357167" alt=""></p>
<blockquote>
<ol>
<li>å¯åŠ¨ç±»åŠ è½½å™¨ï¼šè´Ÿè´£åŠ è½½/libä¸‹çš„ç±»ã€‚</li>
<li>æ‰©å±•ç±»åŠ è½½å™¨ï¼šè´Ÿè´£åŠ è½½/lib/extä¸‹çš„ç±»ã€‚</li>
<li>ç³»ç»Ÿç±»åŠ è½½å™¨/åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ï¼š<code>ClassLoader.getSystemClassLoader</code>è¿”å›çš„å°±æ˜¯å®ƒã€‚</li>
</ol>
</blockquote>
<p>é€šè¿‡ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼Œå­åŠ è½½å™¨ä¸æ–­çš„ç»™ä¸Šä¸€å±‚åŠ è½½å™¨ä¼ é€’åŠ è½½è¯·æ±‚ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å¯åŠ¨ç±»åŠ è½½å™¨åŠ¿å¿…æ˜¯æ¥å—åˆ°è¿‡å…¨éƒ¨çš„åŠ è½½è¯·æ±‚çš„ã€‚å¦‚æœä¸ä¿¡ï¼Œæˆ‘ä»¬å°±ç”¨æºç æ¥è¯æ˜ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; loadClass(String name, <span class="keyword">boolean</span> resolve)</span><br><span class="line">        <span class="keyword">throws</span> ClassNotFoundException</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (getClassLoadingLock(name)) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­Classæ˜¯å¦è¢«åŠ è½½è¿‡</span></span><br><span class="line">            <span class="comment">// è¯´æ˜è¢«åŠ è½½çš„Classå…¶å®æ˜¯åˆ¶ä½œä¸€ä¸ªç¼“å­˜çš„</span></span><br><span class="line">            Class&lt;?&gt; c = findLoadedClass(name);</span><br><span class="line">            <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">long</span> t0 = System.nanoTime();</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span> (parent != <span class="keyword">null</span>) &#123;</span><br><span class="line">                        c = parent.loadClass(name, <span class="keyword">false</span>);</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        c = findBootstrapClassOrNull(name);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span> (ClassNotFoundException e) &#123;</span><br><span class="line">                    <span class="comment">// å¦‚æœçˆ¶ç±»æŠ›å‡ºClassNotFoundException</span></span><br><span class="line">                    <span class="comment">// è¯´æ˜çˆ¶ç±»æ— æ³•å®ŒæˆåŠ è½½</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// è¿™ä¸ªæ—¶å€™cä¾æ—§ä¸ºnullï¼Œè¯´æ˜çˆ¶ç±»åŠ è½½ä¸äº†</span></span><br><span class="line">                <span class="comment">// é‚£æ²¡æœ‰åŠæ³•ï¼Œåªèƒ½å­åŠ è½½å™¨è‡ªå·±æ•ˆåŠ³äº†</span></span><br><span class="line">                <span class="keyword">if</span> (c == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    <span class="keyword">long</span> t1 = System.nanoTime();</span><br><span class="line">                    c = findClass(name);</span><br><span class="line"></span><br><span class="line">                    sun.misc.PerfCounter.getParentDelegationTime().addTime(t1 - t0);</span><br><span class="line">                    sun.misc.PerfCounter.getFindClassTime().addElapsedTimeFrom(t1);</span><br><span class="line">                    sun.misc.PerfCounter.getFindClasses().increment();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (resolve) &#123;</span><br><span class="line">                resolveClass(c);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> c;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è®²å®Œäº†ä»–çš„å·¥ä½œåŸç†ï¼Œè‡ªç„¶å°±è¦çŸ¥é“ï¼Œä»–èƒ½å¤Ÿå¦‚ä½•è¢«ç ´åçš„äº†ã€‚</p>
<h2 id="ç ´ååŒäº²å§”æ´¾æ¨¡å‹"><a href="#ç ´ååŒäº²å§”æ´¾æ¨¡å‹" class="headerlink" title="ç ´ååŒäº²å§”æ´¾æ¨¡å‹"></a>ç ´ååŒäº²å§”æ´¾æ¨¡å‹</h2><p><strong>Q2ï¼šä¸ºä»€ä¹ˆè¦ç ´ååŒäº²å§”æ´¾ï¼Ÿ</strong></p>
<p>æ‹¿æœ€ç®€å•çš„ä¾‹å­ï¼Œåœ¨ä¸Šæ–‡ä¸­æˆ‘ä»¬ï¼Œæåˆ°è¿‡å„ä¸ªèµ„æºçš„åŠ è½½èŒƒå›´ï¼Œä½†æ˜¯<code>Driver</code>ä½œä¸ºåæ¥æ‰åŠ å…¥çš„ä¸€ä¸ªæ¥å£ï¼Œä»–çš„å¾ˆå¤šapiæ˜¯ç”±ç¬¬ä¸‰æ–¹æœåŠ¡å•†å¼€å‘çš„ã€‚é‚£ä¹ˆè¿™ä¸ªæ—¶å€™ï¼Œç ´ååŒäº²å§”æ´¾å°±æœ‰äº†ä»–çš„ç”¨æ­¦ä¹‹åœ°äº†ï¼Œå½“ç„¶è¿™åªæ˜¯ä»–çš„ç”¨å¤„ä¹‹ä¸€ã€‚</p>
<p>ä¸‹é¢æ¥ä»‹ç»ï¼Œä»–æ˜¯å¦‚ä½•ç ´ååŒäº²å§”æ´¾çš„ã€‚</p>
<h3 id="å¦‚ä½•å¼€å±•ç ´åæ´»åŠ¨"><a href="#å¦‚ä½•å¼€å±•ç ´åæ´»åŠ¨" class="headerlink" title="å¦‚ä½•å¼€å±•ç ´åæ´»åŠ¨"></a>å¦‚ä½•å¼€å±•ç ´åæ´»åŠ¨</h3><p>å…ˆçœ‹çœ‹æˆ‘ä»¬å¹³æ—¶éƒ½æ˜¯æ€ä¹ˆç”¨çš„ã€‚ï¼ˆå½“ç„¶è¿™æ˜¯å¾ˆåŸºç¡€çš„å†™æ³•äº†ï¼Œå› ä¸ºç°åœ¨æ± çš„æ¦‚å¿µåŠ æ·±ï¼Œæ‰€ä»¥å¾ˆå¤šäº‹æƒ…éƒ½å·²ç»è¢«å°è£…äº†ã€‚ï¼‰</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">String url = <span class="string">"jdbc:mysql://localhost:3306/db"</span>;</span><br><span class="line">Connection conn = DriverManager.getConnection(url, <span class="string">"root"</span>, <span class="string">"root"</span>);</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢å¾ˆæ˜æ˜¾å°±èƒ½çœ‹å‡ºè¿™ä»¶äº‹æƒ…å°±æ˜¯å…³äº<code>DriverManager</code>å±•å¼€çš„äº†ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> &#123;</span><br><span class="line">    loadInitialDrivers();</span><br><span class="line">    println(<span class="string">"JDBC DriverManager initialized"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™é‡Œæ ¹æ®å‰ä¸€ç« çš„å†…å®¹å…ˆè¦å¯¹<code>DriverManager</code>è¿›è¡Œåˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯è°ƒç”¨äº†ä¸€ä¸ª<code>loadInitialDrivers()</code>å‡½æ•°ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">loadInitialDrivers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        .....</span><br><span class="line">        AccessController.doPrivileged(<span class="keyword">new</span> PrivilegedAction&lt;Void&gt;() &#123;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> Void <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                ServiceLoader&lt;Driver&gt; loadedDrivers = ServiceLoader.load(Driver<span class="class">.<span class="keyword">class</span>)</span>;<span class="comment">// 1</span></span><br><span class="line">                Iterator&lt;Driver&gt; driversIterator = loadedDrivers.iterator();</span><br><span class="line">                <span class="comment">// ã€‚ã€‚ã€‚ã€‚</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        .....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»è¿™ä¸€å°æ®µä¸­ï¼Œæˆ‘ä»¬å…³æ³¨<code>æ³¨é‡Š1</code>èƒ½å¤ŸçŸ¥é“ä»–ä¸“é—¨å»è®¿é—®äº†ä¸€ä¸ª<code>ServiceLoader</code>çš„ç±»ï¼Œç‚¹è¿›å»ä¹‹åæˆ‘ä»¬èƒ½å¤Ÿå‘ç°è¿™ä¹ˆä¸‰æ®µä»£ç ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;S&gt; <span class="function">ServiceLoader&lt;S&gt; <span class="title">load</span><span class="params">(Class&lt;S&gt; service)</span> </span>&#123;</span><br><span class="line">        ClassLoader cl = Thread.currentThread().getContextClassLoader();</span><br><span class="line">        <span class="keyword">return</span> ServiceLoader.load(service, cl);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;S&gt; <span class="function">ServiceLoader&lt;S&gt; <span class="title">load</span><span class="params">(Class&lt;S&gt; service, ClassLoader loader)</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ServiceLoader&lt;&gt;(service, loader);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="title">ServiceLoader</span><span class="params">(Class&lt;S&gt; svc, ClassLoader cl)</span> </span>&#123;</span><br><span class="line">        service = Objects.requireNonNull(svc, <span class="string">"Service interface cannot be null"</span>);</span><br><span class="line">        <span class="comment">// ä¸¤ç§é€‰æ‹©</span></span><br><span class="line">        <span class="comment">// 1. ä½¿ç”¨ç³»ç»Ÿçš„åŠ è½½å™¨ - ClassLoader.getSystemClassLoader()</span></span><br><span class="line">        <span class="comment">// 2. ä½¿ç”¨çº¿ç¨‹ä¸Šä¸‹æ–‡åŠ è½½å™¨ â€” cl</span></span><br><span class="line">        loader = (cl == <span class="keyword">null</span>) ? ClassLoader.getSystemClassLoader() : cl;</span><br><span class="line">        acc = (System.getSecurityManager() != <span class="keyword">null</span>) ? AccessController.getContext() : <span class="keyword">null</span>;</span><br><span class="line">        reload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±1 â€“&gt; 2 â€“&gt; 3çš„é¡ºåºå¾ªåºæ¸è¿›ï¼Œä½ æ˜¯å¦å·²ç»å’Œæˆ‘å…³æ³¨åˆ°ä¸€ä¸ªé—®é¢˜äº†ï¼ï¼ä»€ä¹ˆå«åšçº¿ç¨‹ä¸Šä¸‹æ–‡åŠ è½½å™¨ <strong>ï¼ˆThread.currentThread().getContextClassLoader()ï¼‰</strong>ï¼Ÿ</p>
<p>çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨åœ¨<code>Java 2</code>æ—¶å¼•å…¥ã€‚æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ªå…³è”çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚å¦‚æœä½ é€šè¿‡<code>new Thread()</code>æ–¹å¼æ¥åˆ›å»ºæ–°çš„çº¿ç¨‹ï¼Œæ–°çº¿ç¨‹å°†ç»§æ‰¿å…¶çˆ¶çº¿ç¨‹çš„ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚å¦‚æœç¨‹åºå¯¹çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨æ²¡æœ‰ä»»ä½•æ”¹åŠ¨çš„è¯ï¼Œç¨‹åºä¸­æ‰€æœ‰çš„çº¿ç¨‹å°†éƒ½ä½¿ç”¨åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ä½œä¸ºä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨ã€‚ä½†æ˜¯å¯¹äºä¸‰æ–¹åº“è€Œè¨€ï¼Œåº”ç”¨ç±»åŠ è½½å™¨å»å®Œæˆå­ç±»åŠ è½½å™¨æ‰èƒ½å®Œæˆçš„ä»»åŠ¡æ˜¾ç„¶æ˜¯ä¸å¯èƒ½çš„ï¼Œè¿™å°±éœ€è¦<code>Oracle</code>ç»™ä¸‰æ–¹æä¾›çš„å…¥å£ï¼Œä¹Ÿå°±æ˜¯<code>Thread.currentThread().setContextClassLoader();</code>çš„æ–¹æ³•ï¼Œè®©æˆ‘æœ‰äº†è‡ªå®šä¹‰çš„ç©ºé—´ï¼Œè¿™ä¹Ÿå°±æœ‰æœºä¼šå»å®Œæˆæˆ‘ä»¬æƒ³è¦çš„åŒäº²å§”æ´¾ç ´åäº†ã€‚</p>
<h2 id="æº¯æºClassLoader-getSystemClassLoader"><a href="#æº¯æºClassLoader-getSystemClassLoader" class="headerlink" title="æº¯æºClassLoader.getSystemClassLoader()"></a>æº¯æºClassLoader.getSystemClassLoader()</h2><p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/17067272037aa057?w=996&h=388&f=png&s=52489" alt=""></p>
<p>è¿™å¼ å›¾é‡Œæˆ‘ä»¬åªç”¨å…³æ³¨åœˆçº¢çš„<code>initSystemClassLoader()</code>å‡½æ•°ã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/170672720a2aa7c8?w=986&h=180&f=png&s=38914" alt=""></p>
<p>ç„¶ååœ¨<code>initSystemClassLoader()</code>å‡½æ•°ä¸­è°ƒç”¨äº†ä¸€ä¸ª<code>Launcher</code>çš„ç±»ã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/1706727206c2c102?w=1240&h=496&f=png&s=168402" alt=""></p>
<p>è€Œ<code>Launcher</code>æ•´ä¸ªç±»çš„åˆ›å»ºï¼Œæƒ³æ¥è¯»è€…ä¹Ÿå·²ç»çœ‹åˆ°<code>loader</code>è¿™ä¸ªå˜é‡äº†ï¼Œé€šè¿‡<code>getAppClassLoader()</code>è¿™ä¸ªå‡½æ•°æ‰€åˆ›å»ºçš„<code>loader</code>ä¹Ÿå°±æ˜¯æˆ‘ä»¬å£ä¸­æ‰€è¯´çš„åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨äº†ï¼Œè¿™ä¹Ÿä»æºç ä¸Šè®²è¿°äº†åŒäº²å§”æ´¾æœºåˆ¶çš„å­˜åœ¨ã€‚</p>
<p>å¦å¤–<code>Thread.currentThread().setContextClassLoader(this.loader);</code>è¯æ˜äº†ä¸€ç‚¹ï¼Œå°±æ˜¯å…³äºçº¿ç¨‹ä¸Šä¸‹æ–‡åŠ è½½å™¨é»˜è®¤çš„å°±æ˜¯åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨ã€‚</p>
<h1 id="Javaå†…å­˜æ¨¡å‹"><a href="#Javaå†…å­˜æ¨¡å‹" class="headerlink" title="Javaå†…å­˜æ¨¡å‹"></a>Javaå†…å­˜æ¨¡å‹</h1><p>åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬éœ€è¦çŸ¥é“GCå›æ”¶æœºåˆ¶å›æ”¶çš„æ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬çš„å­˜å‚¨å½¢å¼æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿç­‰ç­‰ä¸€ç³»åˆ—é—®é¢˜ã€‚æ‰€ä»¥å¼•å…¥äº†å†…å­˜æ¨¡å‹çš„æ¦‚å¿µã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/170672773bb0a92f?w=1240&h=797&f=png&s=232679" alt="Javaå†…å­˜æ¨¡å‹"></p>
<p><strong>5å¤§åŒºåŸŸå„è‡ªçš„ä½œç”¨ï¼š</strong></p>
<ol>
<li>ç¨‹åºè®¡æ•°å™¨ï¼šæŒ‡ç¤ºå½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç æ‰§è¡Œåˆ°äº†ç¬¬å‡ è¡Œã€‚</li>
<li>è™šæ‹Ÿæœºæ ˆï¼šä¸ºæ‰§è¡Œçš„æ–¹æ³•åˆ›å»ºæ ˆå¸§ï¼Œä¿å­˜äº†å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œç«™ã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ï¼Œä¸»è¦ç”¨æ¥æ‰§è¡ŒJavaæ–¹æ³•ã€‚</li>
<li>æœ¬åœ°æ–¹æ³•æ ˆï¼šè¿è¡Œæ–¹æ³•ä¸è™šæ‹Ÿæœºæ ˆç›¸ä¼¼ï¼Œä¸»è¦ç”¨æ¥æ‰§è¡Œnativeæ–¹æ³•ã€‚</li>
<li>å †åŒºï¼šç”¨äºå­˜å‚¨å¯¹è±¡çš„å®ä¾‹ã€‚</li>
<li>æ–¹æ³•åŒºï¼šå­˜å‚¨å·²ç»è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ï¼ˆå³åŠ è½½ç±»æ—¶éœ€è¦åŠ è½½çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç‰ˆæœ¬ã€fieldã€æ–¹æ³•ã€æ¥å£ç­‰ä¿¡æ¯ï¼‰ã€finalå¸¸é‡ã€é™æ€å˜é‡ã€ç¼–è¯‘å™¨å³æ—¶ç¼–è¯‘çš„ä»£ç ç­‰ã€‚</li>
</ol>
<p><code>Object</code>ä½œä¸ºæ‰€æœ‰ç±»çš„çˆ¶ç±»ä»¥ä»–åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œå°†æ¶‰åŠå“ªäº›åŒºåŸŸçš„å˜åŠ¨å‘¢ï¼Ÿ</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Object obj = <span class="keyword">new</span> Object();</span><br></pre></td></tr></table></figure>
<p>â‘  <code>Object obj</code>è¡¨ç¤ºä¸€ä¸ªæœ¬åœ°å¼•ç”¨ï¼Œå­˜å‚¨åœ¨è™šæ‹Ÿæœºæ ˆçš„æœ¬åœ°å˜é‡è¡¨ä¸­ï¼Œè¡¨ç¤ºä¸€ä¸ª<code>reference</code>ç±»å‹æ•°æ®ï¼›</p>
<p>â‘¡ <code>new Object()</code>ä½œä¸ºå®ä¾‹å¯¹è±¡æ•°æ®å­˜å‚¨åœ¨å †ä¸­ï¼Œå¦å¤–è¿˜è®°å½•äº†<code>Object</code>ç±»çš„ç±»å‹ä¿¡æ¯ï¼ˆæ¥å£ã€æ–¹æ³•ã€fieldã€å¯¹è±¡ç±»å‹ç­‰ï¼‰çš„åœ°å€ï¼Œè¿™äº›åœ°å€æ‰€æ‰§è¡Œçš„æ•°æ®å­˜å‚¨åœ¨æ–¹æ³•åŒºä¸­ï¼›</p>
<h1 id="GCå›æ”¶æœºåˆ¶"><a href="#GCå›æ”¶æœºåˆ¶" class="headerlink" title="GCå›æ”¶æœºåˆ¶"></a>GCå›æ”¶æœºåˆ¶</h1><p>æ—¢ç„¶è¦åƒåœ¾å›æ”¶ï¼Œé‚£åˆ°åº•è¦å›æ”¶çš„æ˜¯å“ªäº›ä¸œè¥¿å‘¢ï¼Ÿ<br>ä¸Šæ–‡ä¸­<code>Object</code>ç±»çš„ä¸¾ä¾‹ï¼Œå·²ç»æœ‰ä¸€å®šçš„è‹—å¤´äº†ã€‚<br>åœ¨æ–¹æ³•åŒºä¸­çš„æ•°æ®ï¼Œæ˜¯ä»ä¸€å¼€å§‹å°±è¦æ±‚è¢«åŠ å…¥çš„ï¼Œé‚£ä¹ˆå›æ”¶æ‰ä»–ä»¬éš¾å…ä¼šå‡ºç°å„ç§é—®é¢˜ã€‚è€Œåƒ<code>Object</code>è¿™æ ·çš„ç±»ï¼Œåªåœ¨ä¸€æ®µæ—¶é—´å†…éœ€è¦è¢«ä½¿ç”¨ï¼Œä¹Ÿå°±éš¾å…ä¼šæˆä¸ºå¤šå‡ºæ¥çš„ç¢ç‰‡ï¼Œä¹Ÿå°±æˆäº†å…¸å‹çš„â€œå ç€èŒ…å‘ä¸æ‹‰å±â€çš„äº†ã€‚<br>æ‰€ä»¥ï¼Œæ˜¾è€Œæ˜“è§ï¼Œæˆ‘ä»¬è¦å›æ”¶çš„å°±æ˜¯è¿™ä¹ˆä¸€ç±»åƒåœ¾æ•°æ®äº†ï¼Œè€ŒGCå›æ”¶å™¨å›æ”¶çš„ä¹Ÿå°±æ˜¯è¿™ç§<code>new</code>å‡ºæ¥ä»¥åæ²¡ç”¨äº†çš„æ•°æ®äº†ã€‚</p>
<h2 id="å †åŒºçš„ç»†èŠ‚åˆ’åˆ†"><a href="#å †åŒºçš„ç»†èŠ‚åˆ’åˆ†" class="headerlink" title="å †åŒºçš„ç»†èŠ‚åˆ’åˆ†"></a>å †åŒºçš„ç»†èŠ‚åˆ’åˆ†</h2><p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/170672773bafeaca?w=1052&h=370&f=png&s=226110" alt=""></p>
<ul>
<li><p><strong>æ–°ç”Ÿä»£ï¼š</strong> <code>Eden</code> ã€<code>From Space</code>ã€<code>To Space</code><br>åˆšåˆ›å»ºçš„å¯¹è±¡ä¸€èˆ¬éƒ½è¢«æ”¾å…¥<code>Eden</code>ä¸­ï¼Œ<code>Eden</code>æ»¡äº†ä»¥åï¼Œå°±ä¼šè¿›è¡Œä¸€æ¬¡<code>GC</code>æ“ä½œï¼Œåˆ å»æ¶ˆäº¡çš„ï¼ŒæŠŠæ´»è·ƒçš„æ”¾åˆ°<code>From</code>ä¸­ã€‚<strong>ï¼ˆ<code>To Space</code>å’Œ<code>From Space</code>æ˜¯ä¸€ä¸ªè½®æ¢çš„ï¼Œç©ºçš„é‚£ä»½æ•°æ®å°±æ˜¯ä¸‹ä¸€è½®Edenæ»¡æ—¶è¦å­˜æ”¾æ•°æ®çš„From Spaceï¼Œå¦å¤–ä¸€ä¸ªå°±æˆäº†To Spcaeï¼‰</strong> <code>To Space</code>æ»¡äº†çš„æ—¶å€™å°±ä¼šå°†å¯¹è±¡è½¬ç§»åˆ°è€å¹´ä»£ã€‚</p>
</li>
<li><p><strong>è€å¹´ä»£ï¼š</strong> ç»è¿‡äº†å¤šæ¬¡å›æ”¶ï¼Œä½†è¿˜æ˜¯åšå¼ºå­˜æ´»ä¸‹æ¥çš„å¯¹è±¡ä»¬æ‰€åœ¨çš„å†…å­˜ç©ºé—´ã€‚</p>
</li>
</ul>
<h2 id="å¯¹è±¡å­˜æ´»åˆ¤æ–­"><a href="#å¯¹è±¡å­˜æ´»åˆ¤æ–­" class="headerlink" title="å¯¹è±¡å­˜æ´»åˆ¤æ–­"></a>å¯¹è±¡å­˜æ´»åˆ¤æ–­</h2><h3 id="å¼•ç”¨è®¡æ•°"><a href="#å¼•ç”¨è®¡æ•°" class="headerlink" title="å¼•ç”¨è®¡æ•°"></a>å¼•ç”¨è®¡æ•°</h3><p>ä¸€ä¸ªå¯¹è±¡è¢«å¼•ç”¨æ—¶åŠ ä¸€ï¼Œè¢«å»é™¤å¼•ç”¨æ—¶å‡ä¸€ã€‚é‚£ä¹ˆå½“æ•°å€¼ä¸º0æ—¶ï¼Œè¿™ä¸ªå¼•ç”¨å°±æˆä¸ºäº†ä¸€ä¸ªåƒåœ¾ã€‚</p>
<p><strong>ä½†æ˜¯ï¼Œå¦‚æœå­˜åœ¨å¾ªç¯å¼•ç”¨æ—¶ï¼Œå°±ä¸ä¼šç»“æŸå¼•ç”¨ã€‚</strong><br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/5/17282fdaa5f7cf43?w=844&h=520&f=png&s=35795" alt=""></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Aç±»æŒæœ‰Bçš„å¼•ç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    B b;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Bç±»åŒæ ·æŒæœ‰Açš„å¼•ç”¨</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">B</span> </span>&#123;</span><br><span class="line">    A a;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å…·ä½“ä½¿ç”¨</span></span><br><span class="line"><span class="comment">// ä½†æ˜¯åœ¨æµ‹è¯•ä¸­æ˜¯å¯ä»¥å›æ”¶çš„ï¼Œå› ä¸ºæˆ‘ä»¬JVMä½¿ç”¨çš„å¹¶ä¸æ˜¯å¼•ç”¨è®¡æ•°æ³•</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        A a = <span class="keyword">new</span> A();</span><br><span class="line">        B b = <span class="keyword">new</span> B();</span><br><span class="line">        a.b = b;</span><br><span class="line">        b.a = a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¯è¾¾æ€§åˆ†æ"><a href="#å¯è¾¾æ€§åˆ†æ" class="headerlink" title="å¯è¾¾æ€§åˆ†æ"></a>å¯è¾¾æ€§åˆ†æ</h3><p>å’Œå¼•ç”¨è®¡æ•°æ³•æ¯”è¾ƒï¼Œå¯è¾¾æ€§åˆ†ææ³•å¤šäº†ä¸€ä¸ªå«åš<code>GC Root</code>çš„æ¦‚å¿µï¼Œè€Œè¿™äº›<code>GC Roots</code>å°±æ˜¯æˆ‘ä»¬å¯è¾¾æ€§åˆ†ææ³•çš„èµ·ç‚¹ï¼Œåœ¨å‘¨å¿—æ˜å‰è¾ˆçš„ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºã€‹ä¸­å°±å·²ç»æåˆ°è¿‡äº†è¿™ä¸ªæ¦‚å¿µï¼Œå®ƒä¸»è¦åˆ†ä¸ºå‡ ç±»ï¼š</p>
<ul>
<li>åœ¨æ–¹æ³•åŒºä¸­ç±»é™æ€å±æ€§å¼•ç”¨çš„å¯¹è±¡ï¼Œè­¬å¦‚Javaç±»çš„å¼•ç”¨ç±»å‹é™æ€å˜é‡ã€‚</li>
<li>åœ¨æ–¹æ³•åŒºä¸­å¸¸é‡å¼•ç”¨çš„å¯¹è±¡ï¼Œè­¬å¦‚å­—ç¬¦ä¸²å¸¸é‡æ± é‡Œçš„å¼•ç”¨ã€‚</li>
<li>åœ¨æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIå¼•ç”¨çš„å¯¹è±¡ã€‚</li>
<li>åœ¨Javaè™šæ‹Ÿæœºæ ˆä¸­å¼•ç”¨çš„å¯¹è±¡ï¼Œè­¬å¦‚<code>Android</code>çš„ä¸»å…¥å£ç±»<code>ActivityThread</code>ã€‚</li>
<li>æ‰€æœ‰è¢«åŒæ­¥é”æŒæœ‰çš„å¯¹è±¡ã€‚</li>
<li>ã€‚ã€‚ã€‚ã€‚ã€‚</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/5/17282fdaaa897682?w=1100&h=320&f=png&s=50352" alt=""></p>
<h2 id="å›æ”¶ç®—æ³•"><a href="#å›æ”¶ç®—æ³•" class="headerlink" title="å›æ”¶ç®—æ³•"></a>å›æ”¶ç®—æ³•</h2><h3 id="å¤åˆ¶æ”¶é›†"><a href="#å¤åˆ¶æ”¶é›†" class="headerlink" title="å¤åˆ¶æ”¶é›†"></a>å¤åˆ¶æ”¶é›†</h3><p>è¿™æ˜¯ä¸€ä¸ªåº”ç”¨äº<strong>æ–°ç”Ÿä»£</strong>å†…å­˜æ•´ç†çš„æ–¹æ³•ã€‚</p>
<p>å› ä¸ºæ–°ç”Ÿä»£çš„EdenåŒºæ˜¯ä¸€ä¸ªè¿ç»­çš„å†…å­˜ç©ºé—´ <strong>ï¼ˆå æ®æ–°ç”Ÿä»£8æˆï¼‰</strong>ï¼Œé€šè¿‡éå†ï¼ŒæŠŠè¿™ä¸ªå†…å­˜ç©ºé—´çš„æ¶ˆäº¡çš„å¯¹è±¡åˆ å»ï¼Œæ´»è·ƒçš„å¯¹è±¡ä»¬é‡æ–°æ”¾å…¥ä¸€ä¸ªæ–°çš„ç©ºç™½å†…å­˜ç©ºé—´ä¸­ï¼Œä¹Ÿå°±æ˜¯<code>To Space</code>å’Œ<code>From Space</code>çš„ç›¸äº’äº¤æ¢ï¼Œå„å æ®1æˆç©ºé—´ï¼Œå¦å¤–éœ€è¦æ³¨æ„çš„æ˜¯<code>To Space</code>å’Œ<code>From Space</code>ä¸æ˜¯å›ºå®šçš„ï¼Œä¸¤ä¸ªç©ºé—´çš„åç§°å¯ä»¥äº’æ¢ï¼Œå› ä¸ºæ•°æ®æ€»æ˜¯åœ¨è¿™ä¸¤ä¸ªåŒºé—´ä¸­è¶Šè¿ã€‚</p>
<p><strong>å­˜åœ¨é—®é¢˜ï¼šå†…å­˜æŠ˜åŠã€‚</strong></p>
<h3 id="æ ‡è®°æ¸…ç†"><a href="#æ ‡è®°æ¸…ç†" class="headerlink" title="æ ‡è®°æ¸…ç†"></a>æ ‡è®°æ¸…ç†</h3><p>è¿™æ˜¯ä¸€ä¸ªåº”ç”¨äº<strong>è€å¹´ä»£</strong>å†…å­˜æ•´ç†çš„æ–¹æ³•ã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/170672773bf1896a?w=1240&h=459&f=png&s=30279" alt=""></p>
<p>å¦‚å›¾æ‰€ç¤ºï¼Œæœç´¢å‡ºæ´»è·ƒçš„å¯¹è±¡ï¼Œæ¸…é™¤æ¶ˆäº¡å¯¹è±¡ã€‚</p>
<p><strong>å­˜åœ¨é—®é¢˜ï¼šä¼šäº§ç”Ÿç©ºé—´ç¢ç‰‡ã€‚</strong></p>
<h3 id="æ ‡è®°æ•´ç†"><a href="#æ ‡è®°æ•´ç†" class="headerlink" title="æ ‡è®°æ•´ç†"></a>æ ‡è®°æ•´ç†</h3><p>è¿™æ˜¯ä¸€ä¸ªåº”ç”¨äº<strong>è€å¹´ä»£</strong>å†…å­˜æ•´ç†çš„æ–¹æ³•ã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/2/21/170672773bd81fc6?w=1240&h=425&f=png&s=31032" alt=""></p>
<p>æ¯”æ ‡è®°æ¸…ç†ç®—æ³•å¤šä¸€ç‚¹ï¼Œä»–éœ€è¦æ’åºã€‚</p>
<p><strong>å­˜åœ¨é—®é¢˜ï¼šç”¨æ€§èƒ½æ¢å–ç©ºé—´ç¢ç‰‡çš„æ•´ç†ã€‚</strong></p>
<h2 id="å…³äºåƒåœ¾å›æ”¶å™¨"><a href="#å…³äºåƒåœ¾å›æ”¶å™¨" class="headerlink" title="å…³äºåƒåœ¾å›æ”¶å™¨"></a>å…³äºåƒåœ¾å›æ”¶å™¨</h2><ul>
<li><strong>Serialæ”¶é›†å™¨ï¼š</strong> å†å²æœ€æ‚ ä¹…çš„åƒåœ¾å›æ”¶å™¨äº†ï¼Œä»–å¯¹åº”è¿™ä¸€ä¸ªè¯<code>â€œStop The Worldâ€</code>,ä½œä¸ºå•çº¿ç¨‹çš„è¿›è¡Œå¤„ç†åƒåœ¾å›æ”¶å™¨ï¼Œåœ¨å®ƒå¹²æ´»æ—¶ï¼Œç¨‹åºå°å¼Ÿä»¬å¿…é¡»è€è€å®å®ç»™æˆ‘çˆ¬ã€‚</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/172987bc2f140aaa?w=1112&h=227&f=jpeg&s=48345" alt=""></p>
<ul>
<li><p><strong>ParNewæ”¶é›†å™¨ï¼š</strong> æœ¬è´¨ä¸Šè¿˜æ˜¯ä¸<code>Serialæ”¶é›†å™¨</code>ç›¸ä»¿ã€‚å¯¹äºè€å¹´ä»£è€Œè¨€ï¼ŒåŒæ ·é‡‡ç”¨çš„æ˜¯<code>Stop The World</code>çš„æ–¹æ¡ˆï¼Œä½†æ˜¯å¯¹äºæ–°ç”Ÿä»£ï¼Œå¤šçº¿ç¨‹çš„åŠ å…¥æ— ç–‘æ˜¯èƒ½å¤Ÿæé«˜æ•ˆç‡çš„æ–¹æ¡ˆï¼Œå¤šçº¿ç¨‹ä¸­åƒåœ¾æ”¶é›†çš„æ—¶é—´èƒ½å¤Ÿæˆå€æ•°ä¸‹é™ï¼Œä¹Ÿå°±æ›´èƒ½è®©ç”¨æˆ·æ„ŸçŸ¥ä¸åˆ°å¡é¡¿æ„Ÿè§‰ã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/172987c005a96e6a?w=1112&h=230&f=jpeg&s=53583" alt=""></p>
</li>
<li><p><strong>Parallel Scanvengeæ”¶é›†å™¨ï¼š</strong> ä½œä¸ºä¸€æ¬¾ä½¿ç”¨äºæ–°ç”Ÿä»£çš„æ”¶é›†å™¨ï¼Œä½¿ç”¨çš„åƒåœ¾å›æ”¶ç®—æ³•ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸Šé¢å·²ç»æåŠåˆ°çš„å¤åˆ¶ç®—æ³•ã€‚å®ƒæä¾›äº†<code>-XXï¼šMaxGCPauseMillisï¼ˆæœ€å¤§åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´ï¼‰</code>å’Œ<code>-XXï¼šGCTimeRatioï¼ˆååé‡å¤§å°ï¼‰</code>ä¸¤ä¸ªå¯æ§é€‰é¡¹ï¼Œä½†æ˜¯è¦<strong>æ³¨æ„è¿™ä¸¤ä¸ªé€‰é¡¹ï¼ŒåŒæ—¶éƒ½å°æ—¶ï¼Œè¯´æ˜<code>GC</code>çš„æ¬¡æ•°ä¼šæ„ˆåŠ é¢‘ç¹ï¼›è€ŒåŒæ—¶éƒ½å¤§æ—¶ï¼Œä¼šå¯¼è‡´å¡é¡¿æ„Ÿæ˜æ˜¾ã€‚</strong></p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/172988960d419076?w=1035&h=221&f=jpeg&s=47817" alt=""></p>
<ul>
<li><p><strong>Serial Oldæ”¶é›†å™¨ï¼š</strong> æ˜¯ä¸€æ¬¾ä½œç”¨äºè€å¹´ä»£çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä½¿ç”¨çš„åƒåœ¾å›æ”¶ç®—æ³•å°±æ˜¯ <strong>æ ‡è®°-æ•´ç†</strong> ã€‚<br><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/1729887601db989e?w=1120&h=218&f=jpeg&s=49253" alt=""></p>
</li>
<li><p><strong>Parallel Oldæ”¶é›†å™¨ï¼š</strong> åŒæ ·æ˜¯ä¸€æ¬¾ä½œç”¨äºè€å¹´ä»£çš„åƒåœ¾æ”¶é›†å™¨ï¼Œä½¿ç”¨çš„åƒåœ¾å›æ”¶ç®—æ³•å°±æ˜¯ <strong>æ ‡è®°-æ•´ç†</strong> ã€‚</p>
</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/1729889769e4765a?w=1035&h=221&f=jpeg&s=47817" alt=""></p>
<ul>
<li><strong>CMSæ”¶é›†å™¨ï¼š</strong> å®ƒçš„é‡ç‚¹æ—¶éå¸¸å…³æ³¨åº”ç”¨çš„ç›¸åº”é€Ÿåº¦ï¼Œä½¿ç”¨çš„å›æ”¶ç®—æ³•æ˜¯<strong>æ ‡è®°-æ•´ç†</strong> ã€‚å®ƒçš„å·¥ä½œåˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š<code>ï¼ˆ1ï¼‰åˆå§‹æ ‡è®°ã€‚ï¼ˆ2ï¼‰å¹¶å‘æ ‡è®°ã€‚ï¼ˆ3ï¼‰é‡æ–°æ ‡è®°ã€‚ï¼ˆ4ï¼‰å¹¶å‘æ¸…ç†</code>ã€‚å…¶ä¸­ï¼Œåˆå§‹æ ‡è®°å’Œé‡æ–°æ ‡è®°æ˜¯ä¼šå‘ç”Ÿ<code>Stop The World</code>çš„ï¼Œä¸è¿‡æ—¶é—´æ¯”è¾ƒçŸ­ã€‚<ul>
<li><strong>ä¸‰å¤§ç¼ºæ†¾ï¼š</strong> ï¼ˆ1ï¼‰å¯¹å¤„ç†å™¨èµ„æºçš„æ•æ„Ÿï¼Œå¹¶ä¸”è‡ªå·±ä¼šå ç”¨å»ä¸€éƒ¨åˆ†çº¿ç¨‹ï¼Œå¯¼è‡´ååç‡ä¸‹é™ã€‚ï¼ˆ2ï¼‰æ— æ³•å¤„ç†æ ‡è®°å®Œæˆä»¥åå‡ºç°çš„åƒåœ¾ã€‚ï¼ˆ3ï¼‰æ ‡è®°-æ¸…ç†ç®—æ³•çš„ç©ºé—´ç¢ç‰‡é—®é¢˜</li>
</ul>
</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/172988ae99c84c24?w=1114&h=226&f=jpeg&s=70575" alt=""></p>
<ul>
<li><strong>G1å›æ”¶å™¨ï¼š</strong> åŒæ ·çš„éµå¾ªå¹´ä»£åˆ’åˆ†çš„è®¾è®¡ï¼Œä½†æ˜¯é¢å‘çš„å¯¹è±¡çš„å›æ”¶ç­–ç•¥ä»¥æ€§ä»·æ¯”ä½œä¸ºäº†åŸºå‡†ã€‚å›¾ä¸­çš„æ¯ä¸€ä¸ªç©ºæ ¼ä¹Ÿå°±æ˜¯<code>Region</code>çš„å¤§å°æ˜¯å¯ä»¥è®¾å®šçš„ï¼Œè€Œä½œä¸ºå¤§å°çš„åˆ¤æ–­æ˜¯é€šè¿‡å½“å‰å¯¹è±¡å æœ‰çš„<code>Region</code>çš„å¤§å°å æ¯”æ¥è¿›è¡Œåˆ¤å®šçš„ï¼Œå½“ç„¶æˆ‘ä»¬çŸ¥é“ä¼šå‡ºç°è¿™æ ·çš„æ•°æ®ä¸€æ¬¡æ€§å å»äº†å¾ˆå¤šä¸ª<code>Region</code>ï¼Œå› ä¸ºæˆ‘ä»¬è¯´è¿‡ä»–ç»ˆç©¶æ˜¯å­˜åœ¨å¹´ä»£åˆ’åˆ†çš„ï¼Œè¿™æ ·çš„æ•°æ®ç»å¤§å¤šæ•°æŠŠä»–è®¤ä¸ºæ˜¯è€å¹´ä»£çš„æ•°æ®ã€‚è€Œå¯¹äºæ•°æ®å›æ”¶ä¸€èˆ¬ä¼šåˆ†ä¸ºå››ä¸ªæ­¥éª¤ï¼š<code>ï¼ˆ1ï¼‰åˆå§‹æ ‡è®°ï¼ˆ2ï¼‰å¹¶å‘æ ‡è®°ï¼ˆ3ï¼‰æœ€ç»ˆæ ‡è®°ï¼ˆ4ï¼‰ç­›é€‰å›æ”¶</code>ã€‚<blockquote>
<p>å…·ä½“çš„æ“ä½œæ­¥éª¤è¯·çœ‹<strong>whyæŠ€æœ¯</strong>çš„æ–‡ç« </p>
<p><a href="https://juejin.im/post/5e5b15f5f265da57602c547d" target="_blank" rel="noopener">é¢è¯•å®˜é—®æˆ‘G1å›æ”¶å™¨æ€ä¹ˆçŸ¥é“ä½ æ˜¯ä»€ä¹ˆæ—¶å€™çš„åƒåœ¾ï¼Ÿ</a></p>
</blockquote>
</li>
</ul>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/172989914a2d2801?w=653&h=483&f=jpeg&s=40812" alt=""></p>
<p><img src= "/img/loading.gif" data-src="https://user-gold-cdn.xitu.io/2020/6/9/172989cc3ab66742?w=1025&h=222&f=jpeg&s=64066" alt=""></p>
<h1 id="å››å¤§å¼•ç”¨"><a href="#å››å¤§å¼•ç”¨" class="headerlink" title="å››å¤§å¼•ç”¨"></a>å››å¤§å¼•ç”¨</h1><p>ä¸Šé¢æˆ‘ä»¬è¯´åˆ°äº†å›æ”¶å™¨çš„å­˜åœ¨ï¼Œä½†æ˜¯èƒ½å¦å›æ”¶æ‰å†³å®šäº†æˆ‘ä»¬çš„å›æ”¶ç®—æ³•æ˜¯å¦ç”Ÿæ•ˆï¼Œä¸€èˆ¬æ¥è¯´åˆ†ä¸ºä»¥ä¸‹å››ç±»ï¼š</p>
<ul>
<li>å¼ºé¥®ç”¨ï¼šä¸€èˆ¬ä¸ºä½¿ç”¨å…³é”®è¯<code>new</code>å®ä¾‹åŒ–çš„å¯¹è±¡ï¼Œè¿™ç±»å¼•ç”¨GCå›æ”¶å™¨å®å¯æº¢å‡ºï¼Œä¹Ÿä¸ä¼šå›æ”¶ã€‚</li>
<li>è½¯å¼•ç”¨ï¼šæœ‰ç”¨ä½†æ˜¯ä¸å¿…è¦çš„å¯¹è±¡ä»¬ï¼Œåªæœ‰åœ¨å†…å­˜ä¸è¶³æ—¶ï¼Œæ‰ä¼šè¢«GCå›æ”¶å™¨å›æ”¶ã€‚ä¸€èˆ¬ä½¿ç”¨äºç¼“å­˜å„ç§èµ„æºã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SoftReference&lt;String&gt; sr = <span class="keyword">new</span> SoftReference&lt;String&gt;(<span class="keyword">new</span> String(<span class="string">"SoftReference"</span>));</span><br><span class="line">        System.out.println(sr.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>å¼±å¼•ç”¨ï¼šGCå‘ç”Ÿæ—¶å°±ä¼šè¢«å›æ”¶çš„å¯¹è±¡ä»¬ï¼Œæ˜¯ä¸€ç§é˜²æ²»oomçš„æ–¹æ³•ã€‚å¼±å¼•ç”¨çš„åº”ç”¨åœºæ™¯åœ¨æˆ‘çš„ <a href="https://github.com/ClericYi/helper" target="_blank" rel="noopener">Androidå·¥å…·åŒ…MVPæ¡†æ¶</a> ä¸­ä½¿ç”¨åˆ°ï¼Œå¦å¤–åœ¨ä¸Šæ¬¡çš„ <a href="https://juejin.im/post/5ecb1c52518825434b1fb7b4" target="_blank" rel="noopener">é”¦å›Šç¯‡ï½œä¸€æ–‡æ‘¸æ‡‚LeakCanary</a> ä¸­ä¹Ÿæœ‰æåŠã€‚</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        WeakReference&lt;String&gt; sr = <span class="keyword">new</span> WeakReference&lt;String&gt;(<span class="keyword">new</span> String(<span class="string">"WeakReference"</span>));</span><br><span class="line">        System.out.println(sr.get());</span><br><span class="line">        <span class="comment">// gcå›æ”¶åå†æ¬¡æŸ¥çœ‹æ•ˆæœ</span></span><br><span class="line">        System.gc();                </span><br><span class="line">        System.out.println(sr.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>è™šå¼•ç”¨ï¼šå½¢åŒè™šè®¾çš„å¼•ç”¨ã€‚</li>
</ul>
<p><strong>ä¸Šé¢ä¸‰ç§è®²çš„å¾ˆæ¸…æ¥šäº†ï¼Œä½†æ˜¯è¿™ä¸ªè™šå¼•ç”¨åˆ°åº•æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</strong></p>
<p>å®ƒçš„ä½œç”¨åœ¨äºè·Ÿè¸ªåƒåœ¾å›æ”¶è¿‡ç¨‹ï¼Œåœ¨å¯¹è±¡è¢«æ”¶é›†å™¨å›æ”¶æ—¶æ”¶åˆ°ä¸€ä¸ªç³»ç»Ÿé€šçŸ¥ã€‚ å½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨åƒåœ¾å›æ”¶åï¼Œå°†è¿™ä¸ªè™šå¼•ç”¨åŠ å…¥å¼•ç”¨é˜Ÿåˆ—ï¼Œåœ¨å…¶å…³è”çš„è™šå¼•ç”¨å‡ºé˜Ÿå‰ï¼Œä¸ä¼šå½»åº•é”€æ¯è¯¥å¯¹è±¡ã€‚ æ‰€ä»¥å¯ä»¥é€šè¿‡æ£€æŸ¥å¼•ç”¨é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰ç›¸åº”çš„è™šå¼•ç”¨æ¥åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»è¢«å›æ”¶äº†ã€‚æˆ‘ä¸ªäººè®¤ä¸ºå¯ä»¥å’Œå¼±å¼•ç”¨ä¸€æ ·åšä¸€ä¸ªå†…å­˜æ³„æ¼æ£€æŸ¥çš„è§£å†³æ–¹æ¡ˆï¼Œä½†æ˜¯è¿˜ä¸æ¸…æ¥šä»–çš„ç¼ºæ†¾åœ¨å“ªå„¿ã€‚</p>
<h1 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h1><ol>
<li>ã€Šæ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µï¼ˆç¬¬3ç‰ˆï¼‰ã€‹ â€“ å‘¨å¿—æ˜</li>
</ol>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">Cleric Yi</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é“¾æ¥: </span><span class="post-copyright-info"><a href="http://yoursite.com/2020/06/24/%E5%85%B3%E4%BA%8EJVM%EF%BC%8C%E4%BD%A0%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84%E9%82%A3%E4%BA%9B%E7%8E%A9%E6%84%8F%E5%84%BF/">http://yoursite.com/2020/06/24/%E5%85%B3%E4%BA%8EJVM%EF%BC%8C%E4%BD%A0%E5%BF%85%E9%A1%BB%E7%9F%A5%E9%81%93%E7%9A%84%E9%82%A3%E4%BA%9B%E7%8E%A9%E6%84%8F%E5%84%BF/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæƒå£°æ˜: </span><span class="post-copyright-info">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜æ¥è‡ª <a href="http://yoursite.com" target="_blank">ClericYi's Blog</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/06/24/%E9%94%A6%E5%9B%8A%E7%AF%87%EF%BD%9C%E4%B8%80%E6%96%87%E6%91%B8%E6%87%82RxJava/"><img class="next-cover" data-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">é”¦å›Šç¯‡ï½œä¸€æ–‡æ‘¸æ‡‚RxJava</div></div></a></div></nav></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By Cleric Yi</div><div class="framework-info"><span>é©±åŠ¨ </span><a href="https://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><button id="readmode" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="font_plus" title="æ”¾å¤§å­—ä½“"><i class="fas fa-plus"></i></button><button id="font_minus" title="ç¼©å°å­—ä½“"><i class="fas fa-minus"></i></button><button class="translate_chn_to_cht" id="translateLink" title="ç®€ç¹è½¬æ¢">ç¹</button><button id="darkmode" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" title="è®¾ç½®"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><button id="go-up" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script></body></html>